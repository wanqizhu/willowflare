
var ready = function(){




    // $(".clickable-row").click(function() {
    //     window.document.location = $(this).data("href");
    // });
  

    // editUser show/hide profile fields
    $(".showHideButton").on('click',function(e){
        e.preventDefault();
        var id = "#" + $(this).attr('targetID');
        

        if ($(id).css('display') == 'none') {
            $(id).show('slow');
        } else {
            $(id).hide('slow');
        }
        

    });



    // highlight navbar button corresponding to current page
    $("li.btn a").each(function(){              
        if($(this).attr("href")==location.pathname){ /* check relative href address to see which one is active*/
            $(this).parent().addClass('selected');
        }
        else{
            $(this).parent().removeClass("selected");
        }
    });





    // for displaying an image overlay
    // used for terms-of-service

    $(".popupButton").on('click',function(e){
        e.preventDefault();
        

        // since js is running client side, we can't pass the source name to rails
        // so we have to make a "switch" statement for every popup we want -- ugh
        var source = $(this).attr('imagesrc')

        if (source == 'TermsofUse.jpg') {
            $("#infographicImage").attr('src', "<%= asset_path('TermsofUse.jpg') %>");
        } else if (source == 'placeholder.png') {
            $("#infographicImage").attr('src', "<%= asset_path('placeholder.png') %>");
        }

        


        var h = $(this).attr('img_height');
        var w = $(this).attr('img_width');

        if (typeof h == typeof undefined || h == false ) {
            h = "100%";
        }

        // if width is set, use that instead
        if (typeof w == typeof undefined || w == false ) {
            w = "auto";
        } else {
            h = "auto";
        }

        $("#infographicImage").attr('height', h);
        $("#infographicImage").attr('width', w);
        
        $("#infographicPopup").css({'display': '-webkit-flex'
                                   ,'display': 'flex'});
        $('body').css('overflow', 'hidden');
    });
    $('#infographicImage').on('click',function(e){
        e.stopPropagation();
    });
    $("#infographicPopup:not(#infographicImage)").on('click',function(){
        $('#infographicPopup').hide();
        $('body').css('overflow', 'scroll');
        
        // $('html, body').animate({
        //     scrollTop: $("#page").offset().top
        // }, 500);
    });






    $(".redeem").on('click', function(e){
        e.preventDefault;

        var current_pts = parseInt(document.getElementById("willowpoints").innerHTML)
        var name = $(this).attr('value').split('_');
        var cost = parseInt(name[1]);

        if (current_pts < cost) {
            alert("Not enough Willowpoints. Check the annoucement page to see if there are any new opportunities for you to earn rewards!");
        } else {
            if (window.confirm("Are you sure?")) {
                // execute redeem logic here

                //alert("Please pardon our dust as we work to automate this redemption process. For now, you can redeem your rewards by emailing us at info@willowflare.com with your registered email and username.");
                return true;
            }
        }

        return false;
    });

}

$(document).ready(ready);
$(document).on('page:load', ready); // for turbo-links, which doesnt' re-load teh page
                                    // this way, popupButton will work properly after account update